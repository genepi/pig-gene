!piggene.serialisation.Workflow
name: sample_countVariants
description: Counts the number of samples for chrom 20 and pos 138004 that don't match the reference (0/0).
workflow: 
-  comment: Loads the input file.
   input: input1
   input2: '-'
   operation: LOAD
   options: vcf
   options2: '-'
   relation: R1
-  comment: Filters all lines that match chromosome '20'.
   input: R1
   input2: '-'
   operation: FILTER
   options: chrom == '20'
   options2: '-'
   relation: R2
-  comment: Filters all lines that match position '138004'.
   input: R2
   input2: '-'
   operation: FILTER
   options: pos == 138004
   options2: '-'
   relation: R3
-  comment: Filters all lines that doesn't contain genotype information which matches the reference (0/0).
   input: R3
   input2: '-'
   operation: FILTER
   options: SUBSTRING(genotype,0,3) != '0/0'
   options2: '-'
   relation: R4
-  comment: Groups all lines by using the chromosome and position column.
   input: '-'
   input2: '-'
   operation: SCRIPT
   options: R5 = GROUP R4 BY (chrom,pos);
   options2: '-'
   relation: script
-  comment: Selects the needed columns for the output. The grouped columns (chrom,pos) get flattened to
      separate them into two distinct columns. The COUNT operation counts the number of grouped elements
      for each group consisting of (chrom,pos).
   input: R5
   input2: '-'
   operation: SELECT
   options: FLATTEN(group), COUNT(R4) as count
   options2: '-'
   relation: R6
-  comment: Stores the output.
   input: R6
   input2: '-'
   operation: STORE
   options: '-'
   options2: '-'
   relation: output1
