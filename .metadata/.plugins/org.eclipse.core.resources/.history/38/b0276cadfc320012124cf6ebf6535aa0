/**
 * PigGene - BACHELOR PROJECT
 * 
 * Pig script to filter the exome information 
 * and create columns for each of the PL-values 
 * and a column for the GQ-value. Stores the
 * output into the specified folder.
 * 
 * call this script like this:
 * pig -param input=GeneSamples/input/plGqTestinput.txt -param output=GeneSamples/output extractPL_GQ_values.pig
 * 
 * @author: Clemens Banas
 */
 
 REGISTER pigGene.jar;
 
 in = LOAD '$input' USING pigGene.PigGeneStorage();
 
 out = FOREACH in {
  pl_split = STRSPLIT(genotype,':');
  /* 
  pl_splitFlat = FOREACH pl_split GENERATE FLATTEN(pl_split);
  pl_1 = FOREACH pl_splitFlat GENERATE pl_splitFlat.$0;
  *
  */
  GENERATE *, FLATTEN(pl_split.$2);
 };
 
 STORE out INTO '$output';