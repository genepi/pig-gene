/* pig -param input=GeneSamples/in tessssssst.pig */

REGISTER pigGene.jar;
/*samples = LOAD '$input' USING pigGene.PigStorageWithFilename() 
			AS (chrom:chararray, pos:int, id:chararray, ref:chararray, 
						alt:chararray, qual:float, filt:chararray, info:chararray, 
									format:chararray, exome:chararray, filename:chararray);
	*/
	
	
REGISTER pigGene.jar;
samples = LOAD '$input' USING PigStorage('\t','-tagsource')
			AS (filename:chararray, chrom:chararray, pos:int, id:chararray, ref:chararray, 
						alt:chararray, qual:float, filt:chararray, info:chararray, 
									format:chararray, exome:chararray);
									
samp = FILTER samples BY pigGene.IgnoreHeader(chrom);
sampf = FILTER samp BY pigGene.FilterChromosome(chrom);
sfu = FOREACH sampf GENERATE chrom,pos,filename; /* filename */

dump sfu;