<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta content="Apache Forrest" name="Generator">
<meta name="Forrest-version" content="0.8">
<meta name="Forrest-skin-name" content="pelt">
<title>Built In Functions</title>
<link type="text/css" href="skin/basic.css" rel="stylesheet">
<link media="screen" type="text/css" href="skin/screen.css" rel="stylesheet">
<link media="print" type="text/css" href="skin/print.css" rel="stylesheet">
<link type="text/css" href="skin/profile.css" rel="stylesheet">
<script src="skin/getBlank.js" language="javascript" type="text/javascript"></script><script src="skin/getMenu.js" language="javascript" type="text/javascript"></script><script src="skin/fontsize.js" language="javascript" type="text/javascript"></script>
<link rel="shortcut icon" href="">
</head>
<body onload="init()">
<script type="text/javascript">ndeSetTextSize();</script>
<div id="top">
<!--+
    |breadtrail
    +-->
<div class="breadtrail">
<a href="http://www.apache.org/">Apache</a> &gt; <a href="http://hadoop.apache.org/">Hadoop</a> &gt; <a href="http://hadoop.apache.org/pig/">Pig</a><script src="skin/breadcrumbs.js" language="JavaScript" type="text/javascript"></script>
</div>
<!--+
    |header
    +-->
<div class="header">
<!--+
    |start group logo
    +-->
<div class="grouplogo">
<a href="http://hadoop.apache.org/"><img class="logoImage" alt="Hadoop" src="images/hadoop-logo.jpg" title="Apache Hadoop"></a>
</div>
<!--+
    |end group logo
    +-->
<!--+
    |start Project Logo
    +-->
<div class="projectlogo">
<a href="http://hadoop.apache.org/pig/"><img class="logoImage" alt="Pig" src="images/pig-logo.gif" title="A platform for analyzing large datasets."></a>
</div>
<!--+
    |end Project Logo
    +-->
<!--+
    |start Search
    +-->
<div class="searchbox">
<form action="http://www.google.com/search" method="get" class="roundtopsmall">
<input value="" name="sitesearch" type="hidden"><input onFocus="getBlank (this, 'Search the site with google');" size="25" name="q" id="query" type="text" value="Search the site with google">&nbsp; 
                    <input name="Search" value="Search" type="submit">
</form>
</div>
<!--+
    |end search
    +-->
<!--+
    |start Tabs
    +-->
<ul id="tabs">
<li>
<a class="unselected" href="http://hadoop.apache.org/pig/">Project</a>
</li>
<li>
<a class="unselected" href="http://wiki.apache.org/pig/">Wiki</a>
</li>
<li class="current">
<a class="selected" href="index.html">Pig 0.10.0 Documentation</a>
</li>
</ul>
<!--+
    |end Tabs
    +-->
</div>
</div>
<div id="main">
<div id="publishedStrip">
<!--+
    |start Subtabs
    +-->
<div id="level2tabs"></div>
<!--+
    |end Endtabs
    +-->
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<!--+
    |breadtrail
    +-->
<div class="breadtrail">

             &nbsp;
           </div>
<!--+
    |start Menu, mainarea
    +-->
<!--+
    |start Menu
    +-->
<div id="menu">
<div onclick="SwitchMenu('menu_selected_1.1', 'skin/')" id="menu_selected_1.1Title" class="menutitle" style="background-image: url('skin/images/chapter_open.gif');">Pig</div>
<div id="menu_selected_1.1" class="selectedmenuitemgroup" style="display: block;">
<div class="menuitem">
<a href="index.html">Overview</a>
</div>
<div class="menuitem">
<a href="start.html">Getting Started</a>
</div>
<div class="menuitem">
<a href="basic.html">Pig Latin Basics</a>
</div>
<div class="menupage">
<div class="menupagetitle">Built In Functions</div>
</div>
<div class="menuitem">
<a href="udf.html">User Defined Functions</a>
</div>
<div class="menuitem">
<a href="cont.html">Control Structures</a>
</div>
<div class="menuitem">
<a href="cmds.html">Shell and Utililty Commands</a>
</div>
<div class="menuitem">
<a href="perf.html">Performance and Efficiency</a>
</div>
<div class="menuitem">
<a href="test.html">Testing and Diagnostics</a>
</div>
<div class="menuitem">
<a href="pig-index.html">Index</a>
</div>
</div>
<div onclick="SwitchMenu('menu_1.2', 'skin/')" id="menu_1.2Title" class="menutitle">Miscellaneous</div>
<div id="menu_1.2" class="menuitemgroup">
<div class="menuitem">
<a href="api/">API Docs</a>
</div>
<div class="menuitem">
<a href="jdiff/changes.html">API Changes</a>
</div>
<div class="menuitem">
<a href="https://cwiki.apache.org/confluence/display/PIG">Wiki</a>
</div>
<div class="menuitem">
<a href="https://cwiki.apache.org/confluence/display/PIG/FAQ">FAQ</a>
</div>
<div class="menuitem">
<a href="http://hadoop.apache.org/pig/releases.html">Release Notes</a>
</div>
</div>
<div id="credit"></div>
<div id="roundbottom">
<img style="display: none" class="corner" height="15" width="15" alt="" src="skin/images/rc-b-l-15-1body-2menu-3menu.png"></div>
<!--+
  |alternative credits
  +-->
<div id="credit2"></div>
</div>
<!--+
    |end Menu
    +-->
<!--+
    |start content
    +-->
<div id="content">
<div title="Portable Document Format" class="pdflink">
<a class="dida" href="func.pdf"><img alt="PDF -icon" src="skin/images/pdfdoc.gif" class="skin"><br>
        PDF</a>
</div>
<h1>Built In Functions</h1>
<div id="minitoc-area">
<ul class="minitoc">
<li>
<a href="#built-in-functions">Introduction</a>
</li>
<li>
<a href="#dynamic-invokers">Dynamic Invokers</a>
</li>
<li>
<a href="#eval-functions">Eval Functions</a>
<ul class="minitoc">
<li>
<a href="#avg">AVG</a>
</li>
<li>
<a href="#concat">CONCAT</a>
</li>
<li>
<a href="#count">COUNT</a>
</li>
<li>
<a href="#count-star">COUNT_STAR</a>
</li>
<li>
<a href="#diff">DIFF</a>
</li>
<li>
<a href="#isempty">IsEmpty</a>
</li>
<li>
<a href="#max">MAX</a>
</li>
<li>
<a href="#min">MIN</a>
</li>
<li>
<a href="#size">SIZE</a>
</li>
<li>
<a href="#sum">SUM</a>
</li>
<li>
<a href="#tokenize">TOKENIZE</a>
</li>
</ul>
</li>
<li>
<a href="#load-store-functions">Load/Store Functions</a>
<ul class="minitoc">
<li>
<a href="#handling-compression">Handling Compression</a>
</li>
<li>
<a href="#binstorage">BinStorage</a>
</li>
<li>
<a href="#jsonloadstore">JsonLoader, JsonStorage</a>
</li>
<li>
<a href="#pigdump">PigDump</a>
</li>
<li>
<a href="#pigstorage">PigStorage</a>
</li>
<li>
<a href="#textloader">TextLoader</a>
</li>
</ul>
</li>
<li>
<a href="#math-functions">Math Functions</a>
<ul class="minitoc">
<li>
<a href="#abs">ABS</a>
</li>
<li>
<a href="#acos">ACOS</a>
</li>
<li>
<a href="#asin">ASIN</a>
</li>
<li>
<a href="#atan">ATAN</a>
</li>
<li>
<a href="#cbrt">CBRT</a>
</li>
<li>
<a href="#ceil">CEIL</a>
</li>
<li>
<a href="#cos">COS</a>
</li>
<li>
<a href="#cosh">COSH</a>
</li>
<li>
<a href="#exp">EXP</a>
</li>
<li>
<a href="#floor">FLOOR</a>
</li>
<li>
<a href="#log">LOG</a>
</li>
<li>
<a href="#log10">LOG10</a>
</li>
<li>
<a href="#random">RANDOM</a>
</li>
<li>
<a href="#round">ROUND</a>
</li>
<li>
<a href="#sin">SIN</a>
</li>
<li>
<a href="#sinh">SINH</a>
</li>
<li>
<a href="#sqrt">SQRT</a>
</li>
<li>
<a href="#tan">TAN</a>
</li>
<li>
<a href="#tanh">TANH</a>
</li>
</ul>
</li>
<li>
<a href="#string-functions">String Functions</a>
<ul class="minitoc">
<li>
<a href="#indexof">INDEXOF</a>
</li>
<li>
<a href="#last-index-of">LAST_INDEX_OF</a>
</li>
<li>
<a href="#lcfirst">LCFIRST</a>
</li>
<li>
<a href="#lower">LOWER</a>
</li>
<li>
<a href="#regex-extract">REGEX_EXTRACT </a>
</li>
<li>
<a href="#regex-extract-all">REGEX_EXTRACT_ALL </a>
</li>
<li>
<a href="#replace">REPLACE</a>
</li>
<li>
<a href="#strsplit">STRSPLIT</a>
</li>
<li>
<a href="#substring">SUBSTRING</a>
</li>
<li>
<a href="#trim">TRIM</a>
</li>
<li>
<a href="#ucfirst">UCFIRST</a>
</li>
<li>
<a href="#upper">UPPER</a>
</li>
</ul>
</li>
<li>
<a href="#bag-tuple-functions">Tuple, Bag, Map Functions</a>
<ul class="minitoc">
<li>
<a href="#totuple">TOTUPLE</a>
</li>
<li>
<a href="#tobag">TOBAG</a>
</li>
<li>
<a href="#tomap">TOMAP</a>
</li>
<li>
<a href="#topx">TOP</a>
</li>
</ul>
</li>
</ul>
</div>
  

<a name="N1000D"></a><a name="built-in-functions"></a>
<h2 class="h3">Introduction</h2>
<div class="section">
<p>
Pig comes with a set of built in functions (the eval, load/store, math, string, bag and tuple functions). Two main properties differentiate built in functions from <a href="udf.html">user defined  functions</a> (UDFs). First, built in functions don't need to be registered because Pig knows where they are. Second, built in functions don't need to be qualified when they are used because Pig knows where to find them. 
</p>
</div>

<!-- ================================================================== -->
<!-- DYNAMIC INVOKERS -->

<a name="N1001F"></a><a name="dynamic-invokers"></a>
<h2 class="h3">Dynamic Invokers</h2>
<div class="section">
<p>Often you may need to use a simple function that is already provided by standard Java libraries, but for which a <a href="udf.html">user defined  functions</a> (UDF) has not been written. Dynamic invokers allow you to refer to Java functions without having to wrap them in custom UDFs, at the cost of doing some Java reflection on every function call. 
</p>
<pre class="code">
...
DEFINE UrlDecode InvokeForString('java.net.URLDecoder.decode', 'String String'); 
encoded_strings = LOAD 'encoded_strings.txt' as (encoded:chararray); 
decoded_strings = FOREACH encoded_strings GENERATE UrlDecode(encoded, 'UTF-8'); 
...
</pre>
<p>Currently, dynamic invokers can be used for any static function that: </p>
<ul>

<li>Accepts no arguments or accepts some combination of strings, ints, longs, doubles, floats, or arrays with these same types </li>

<li>Returns a string, an int, a long, a double, or a float</li>

</ul>
<p>Only primitives can be used for numbers; no capital-letter numeric classes can be used as arguments. Depending on the return type, a specific kind of invoker must be used: InvokeForString, InvokeForInt, InvokeForLong, InvokeForDouble, or InvokeForFloat. </p>
<p>The <a href="basic.html#define">DEFINE</a> statement is used to bind a keyword to a Java method, as above. The first argument to the InvokeFor* constructor is the full path to the desired method. The second argument is a space-delimited ordered list of the classes of the method arguments. This can be omitted or an empty string if the method takes no arguments. Valid class names are string, long, float, double, and int. Invokers can also work with array arguments, represented in Pig as DataBags of single-tuple elements. Simply refer to string[], for example. Class names are not case sensitive. </p>
<p>The ability to use invokers on methods that take array arguments makes methods like those in org.apache.commons.math.stat.StatUtils available (for processing the results of grouping your datasets, for example). This is helpful, but a word of caution: the resulting UDF will not be optimized for Hadoop, and the very significant benefits one gains from implementing the Algebraic and Accumulator interfaces are lost here. Be careful if you use invokers this way.</p>
</div>
  
<!-- ======================================================== -->  
<!-- EVAL FUNCTIONS -->    

<a name="N1004E"></a><a name="eval-functions"></a>
<h2 class="h3">Eval Functions</h2>
<div class="section">
<a name="N10056"></a><a name="avg"></a>
<h3 class="h4">AVG</h3>
<p>Computes the average of the numeric values in a single-column bag. </p>
<a name="N1005F"></a><a name="Syntax"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4"> 
      
<tr>
            
<td colspan="1" rowspan="1">
               
<p>AVG(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10074"></a><a name="Terms"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>Any expression whose result is a bag. The elements of the bag should be data type int, long, float, or double.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10091"></a><a name="Usage"></a>
<h4>Usage</h4>
<p>Use the AVG function to compute the average of the numeric values in a single-column bag. 
   AVG requires a preceding GROUP ALL statement for global averages and a GROUP BY statement for group averages.</p>
<p>The AVG function now ignores NULL values. </p>
<a name="N1009E"></a><a name="Example"></a>
<h4>Example</h4>
<p>In this example the average GPA for each student is computed (see the <a href="basic.html#GROUP">GROUP</a> operator for information about the field names in relation B).</p>
<pre class="code">
A = LOAD 'student.txt' AS (name:chararray, term:chararray, gpa:float);

DUMP A;
(John,fl,3.9F)
(John,wt,3.7F)
(John,sp,4.0F)
(John,sm,3.8F)
(Mary,fl,3.8F)
(Mary,wt,3.9F)
(Mary,sp,4.0F)
(Mary,sm,4.0F)

B = GROUP A BY name;

DUMP B;
(John,{(John,fl,3.9F),(John,wt,3.7F),(John,sp,4.0F),(John,sm,3.8F)})
(Mary,{(Mary,fl,3.8F),(Mary,wt,3.9F),(Mary,sp,4.0F),(Mary,sm,4.0F)})

C = FOREACH B GENERATE A.name, AVG(A.gpa);

DUMP C;
({(John),(John),(John),(John)},3.850000023841858)
({(Mary),(Mary),(Mary),(Mary)},3.925000011920929)
</pre>
<a name="N100B0"></a><a name="Types+Tables"></a>
<h4>Types Tables</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p></p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>bytearray </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>AVG </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>error </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>cast as double </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10131"></a><a name="concat"></a>
<h3 class="h4">CONCAT</h3>
<p>Concatenates two expressions of identical type.</p>
<a name="N1013A"></a><a name="Syntax-N1013A"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>CONCAT (expression, expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1014F"></a><a name="Terms-N1014F"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>Any expression.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1016C"></a><a name="Usage-N1016C"></a>
<h4>Usage</h4>
<p>Use the CONCAT function to concatenate two expressions. The result values of the two expressions must have identical types.</p>
<a name="N10176"></a><a name="Example-N10176"></a>
<h4>Example</h4>
<p>In this example fields f2 and f3 are concatenated.</p>
<pre class="code">
A = LOAD 'data' as (f1:chararray, f2:chararray, f3:chararray);

DUMP A;
(apache,open,source)
(hadoop,map,reduce)
(pig,pig,latin)

X = FOREACH A GENERATE CONCAT(f2,f3);

DUMP X;
(opensource)
(mapreduce)
(piglatin)
</pre>
<a name="N10187"></a><a name="count"></a>
<h3 class="h4">COUNT</h3>
<p>Computes the number of elements in a bag. </p>
<a name="N10190"></a><a name="Syntax-N10190"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>COUNT(expression) </p>
            
</td>
         
</tr> 
   
</table>
<a name="N101A4"></a><a name="Terms-N101A4"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with data type bag.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N101C0"></a><a name="Usage-N101C0"></a>
<h4>Usage</h4>
<p>Use the COUNT function to compute the number of elements in a bag.
   COUNT requires a preceding GROUP ALL statement for global counts and a GROUP BY statement for group counts.</p>
<p>
    The COUNT function follows syntax semantics and ignores nulls. 
    What this means is that a tuple in the bag will not be counted if the FIRST FIELD in this tuple is NULL. 
    If you want to include NULL values in the count computation, use 
    <a href="#COUNT-STAR">COUNT_STAR</a>.
   </p>
<p>
    Note: You cannot use the tuple designator (*) with COUNT; that is, COUNT(*) will not work.   
   </p>
<a name="N101D4"></a><a name="Example-N101D4"></a>
<h4>Example</h4>
<p>In this example the tuples in the bag are counted (see the <a href="basic.html#GROUP">GROUP</a> operator for information about the field names in relation B).</p>
<pre class="code">
A = LOAD 'data' AS (f1:int,f2:int,f3:int);

DUMP A;
(1,2,3)
(4,2,1)
(8,3,4)
(4,3,3)
(7,2,5)
(8,4,3)

B = GROUP A BY f1;

DUMP B;
(1,{(1,2,3)})
(4,{(4,2,1),(4,3,3)})
(7,{(7,2,5)})
(8,{(8,3,4),(8,4,3)})

X = FOREACH B GENERATE COUNT(A);

DUMP X;
(1L)
(2L)
(1L)
(2L)
</pre>
<a name="N101E6"></a><a name="Types+Tables-N101E6"></a>
<h4>Types Tables</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p></p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>bytearray </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>COUNT </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10267"></a><a name="count-star"></a>
<h3 class="h4">COUNT_STAR</h3>
<p>Computes the number of elements in a bag. </p>
<a name="N10270"></a><a name="Syntax-N10270"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>COUNT_STAR(expression)&nbsp; </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10285"></a><a name="Terms-N10285"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with data type bag.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N102A2"></a><a name="Usage-N102A2"></a>
<h4>Usage</h4>
<p>Use the COUNT_STAR function to compute the number of elements in a bag.
   COUNT_STAR requires a preceding GROUP ALL statement for global counts and a GROUP BY statement for group counts.</p>
<p>COUNT_STAR includes NULL values in the count computation 
   (unlike <a href="#COUNT">COUNT</a>, which ignores NULL values).
   </p>
<a name="N102B3"></a><a name="Example-N102B3"></a>
<h4>Example</h4>
<p>In this example COUNT_STAR is used the count the tuples in a bag.</p>
<pre class="code">
X = FOREACH B GENERATE COUNT_STAR(A);
</pre>
<a name="N102C4"></a><a name="diff"></a>
<h3 class="h4">DIFF</h3>
<p>Compares two fields in a tuple.</p>
<a name="N102CD"></a><a name="Syntax-N102CD"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>DIFF (expression, expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N102E1"></a><a name="Terms-N102E1"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with any data type.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N102FE"></a><a name="Usage-N102FE"></a>
<h4>Usage</h4>
<p>The DIFF function takes two bags as arguments and compares them. 
   Any tuples that are in one bag but not the other are returned in a bag. 
   If the bags match, an empty bag is returned. If the fields are not bags 
   then they will be wrapped in tuples and returned in a bag if they do not match, 
   or an empty bag will be returned if the two records match. The implementation 
   assumes that both bags being passed to the DIFF function will fit entirely 
   into memory simultaneously. If this is not the case the UDF will still function 
   but it will be VERY slow.</p>
<a name="N10308"></a><a name="Example-N10308"></a>
<h4>Example</h4>
<p>In this example DIFF compares the tuples in two bags.</p>
<pre class="code">
A = LOAD 'bag_data' AS (B1:bag{T1:tuple(t1:int,t2:int)},B2:bag{T2:tuple(f1:int,f2:int)});

DUMP A;
({(8,9),(0,1)},{(8,9),(1,1)})
({(2,3),(4,5)},{(2,3),(4,5)})
({(6,7),(3,7)},{(2,2),(3,7)})

DESCRIBE A;
a: {B1: {T1: (t1: int,t2: int)},B2: {T2: (f1: int,f2: int)}}

X = FOREACH A DIFF(B1,B2);

grunt&gt; dump x;
({(0,1),(1,1)})
({})
({(6,7),(2,2)})
</pre>
<a name="N10318"></a><a name="isempty"></a>
<h3 class="h4">IsEmpty</h3>
<p>Checks if a bag or map is empty.</p>
<a name="N10321"></a><a name="Syntax-N10321"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>IsEmpty(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10335"></a><a name="Terms-N10335"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with any data type.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10351"></a><a name="Usage-N10351"></a>
<h4>Usage</h4>
<p>The IsEmpty function checks if a bag or map is empty (has no data). The function can be used to filter data.</p>
<a name="N1035A"></a><a name="Example-N1035A"></a>
<h4>Example</h4>
<p>In this example all students with an SSN but no name are located.</p>
<pre class="code">
SSN = load 'ssn.txt' using PigStorage() as (ssn:long);

SSN_NAME = load 'students.txt' using PigStorage() as (ssn:long, name:chararray);

/* do a left outer join of SSN with SSN_Name */
X = JOIN SSN by ssn LEFT OUTER, SSN_NAME by ssn;

/* only keep those ssn's for which there is no name */
Y = filter X by IsEmpty(SSN_NAME);
</pre>
<a name="N1036A"></a><a name="max"></a>
<h3 class="h4">MAX</h3>
<p>Computes the maximum of the numeric values or chararrays in a single-column bag. MAX requires a preceding GROUP ALL statement for global maximums and a GROUP BY statement for group maximums.</p>
<a name="N10373"></a><a name="Syntax-N10373"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>MAX(expression)&nbsp; &nbsp; &nbsp; &nbsp; </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10387"></a><a name="Terms-N10387"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with data types int, long, float, double, or chararray.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N103A3"></a><a name="Usage-N103A3"></a>
<h4>Usage</h4>
<p>Use the MAX function to compute the maximum of the numeric values or chararrays in a single-column bag.</p>
<a name="N103AC"></a><a name="Example-N103AC"></a>
<h4>Example</h4>
<p>In this example the maximum GPA for all terms is computed for each student (see the GROUP operator for information about the field names in relation B).</p>
<pre class="code">
A = LOAD 'student' AS (name:chararray, session:chararray, gpa:float);

DUMP A;
(John,fl,3.9F)
(John,wt,3.7F)
(John,sp,4.0F)
(John,sm,3.8F)
(Mary,fl,3.8F)
(Mary,wt,3.9F)
(Mary,sp,4.0F)
(Mary,sm,4.0F)

B = GROUP A BY name;

DUMP B;
(John,{(John,fl,3.9F),(John,wt,3.7F),(John,sp,4.0F),(John,sm,3.8F)})
(Mary,{(Mary,fl,3.8F),(Mary,wt,3.9F),(Mary,sp,4.0F),(Mary,sm,4.0F)})

X = FOREACH B GENERATE group, MAX(A.gpa);

DUMP X;
(John,4.0F)
(Mary,4.0F)
</pre>
<a name="N103BA"></a><a name="Types+Tables-N103BA"></a>
<h4>Types Tables</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p></p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>bytearray </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>MAX </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>cast as double</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1043B"></a><a name="min"></a>
<h3 class="h4">MIN</h3>
<p>Computes the minimum of the numeric values or chararrays in a single-column bag. MIN requires a preceding GROUP&hellip; ALL statement for global minimums and a GROUP &hellip; BY statement for group minimums.</p>
<a name="N10444"></a><a name="Syntax-N10444"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>MIN(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10458"></a><a name="Terms-N10458"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with data types int, long, float, double, or chararray.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10474"></a><a name="Usage-N10474"></a>
<h4>Usage</h4>
<p>Use the MIN function to compute the minimum of a set of numeric values or chararrays in a single-column bag.</p>
<a name="N1047D"></a><a name="Example-N1047D"></a>
<h4>Example</h4>
<p>In this example the minimum GPA for all terms is computed for each student (see the GROUP operator for information about the field names in relation B).</p>
<pre class="code">
A = LOAD 'student' AS (name:chararray, session:chararray, gpa:float);

DUMP A;
(John,fl,3.9F)
(John,wt,3.7F)
(John,sp,4.0F)
(John,sm,3.8F)
(Mary,fl,3.8F)
(Mary,wt,3.9F)
(Mary,sp,4.0F)
(Mary,sm,4.0F)

B = GROUP A BY name;

DUMP B;
(John,{(John,fl,3.9F),(John,wt,3.7F),(John,sp,4.0F),(John,sm,3.8F)})
(Mary,{(Mary,fl,3.8F),(Mary,wt,3.9F),(Mary,sp,4.0F),(Mary,sm,4.0F)})

X = FOREACH B GENERATE group, MIN(A.gpa);

DUMP X;
(John,3.7F)
(Mary,3.8F)
</pre>
<a name="N1048B"></a><a name="Types+Tables-N1048B"></a>
<h4>Types Tables</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p></p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>bytearray </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>MIN </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>cast as double</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1050C"></a><a name="size"></a>
<h3 class="h4">SIZE</h3>
<p>Computes the number of elements based on any Pig data type. </p>
<a name="N10515"></a><a name="Syntax-N10515"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SIZE(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10529"></a><a name="Terms-N10529"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with any data type.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10545"></a><a name="Usage-N10545"></a>
<h4>Usage</h4>
<p>Use the SIZE function to compute the number of elements based on the data type (see the Types Tables below). 
   SIZE includes NULL values in the size computation. SIZE is not algebraic.</p>
<a name="N1054F"></a><a name="Example-N1054F"></a>
<h4>Example</h4>
<p>In this example the number of characters in the first field is computed.</p>
<pre class="code">
A = LOAD 'data' as (f1:chararray, f2:chararray, f3:chararray);
(apache,open,source)
(hadoop,map,reduce)
(pig,pig,latin)

X = FOREACH A GENERATE SIZE(f1);

DUMP X;
(6L)
(6L)
(3L)
</pre>
<a name="N1055D"></a><a name="Types+Tables-N1055D"></a>
<h4>Types Tables</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns 1 </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns 1 </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns 1 </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns 1 </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns number of characters in the array </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>bytearray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns number of bytes in the array </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>tuple </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns number of fields in the tuple</p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>bag </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns number of tuples in bag </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>map </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>returns number of key/value pairs in map </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10613"></a><a name="sum"></a>
<h3 class="h4">SUM</h3>
<p>Computes the sum of the numeric values in a single-column bag. SUM requires a preceding GROUP ALL statement for global sums and a GROUP BY statement for group sums.</p>
<a name="N1061C"></a><a name="Syntax-N1061C"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SUM(expression)&nbsp; &nbsp; &nbsp; &nbsp; </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10630"></a><a name="Terms-N10630"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with data types int, long, float, double, or bytearray cast as double.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1064C"></a><a name="Usage-N1064C"></a>
<h4>Usage</h4>
<p>Use the SUM function to compute the sum of a set of numeric values in a single-column bag.</p>
<a name="N10655"></a><a name="Example-N10655"></a>
<h4>Example</h4>
<p>In this example the number of pets is computed. (see the GROUP operator for information about the field names in relation B).</p>
<pre class="code">
A = LOAD 'data' AS (owner:chararray, pet_type:chararray, pet_num:int);

DUMP A;
(Alice,turtle,1)
(Alice,goldfish,5)
(Alice,cat,2)
(Bob,dog,2)
(Bob,cat,2) 

B = GROUP A BY owner;

DUMP B;
(Alice,{(Alice,turtle,1),(Alice,goldfish,5),(Alice,cat,2)})
(Bob,{(Bob,dog,2),(Bob,cat,2)})

X = FOREACH B GENERATE group, SUM(A.pet_num);
DUMP X;
(Alice,8L)
(Bob,4L)
</pre>
<a name="N10663"></a><a name="Types+Tables-N10663"></a>
<h4>Types Tables</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p></p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>int </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>float </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>chararray </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>bytearray </p>
            
</td>
         
</tr>
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SUM </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>long </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>double </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>error </p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>cast as double </p>
            
</td>
         
</tr> 
   
</table>
<a name="N106E4"></a><a name="tokenize"></a>
<h3 class="h4">TOKENIZE</h3>
<p>Splits a string and outputs a bag of words. </p>
<a name="N106ED"></a><a name="Syntax-N106ED"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TOKENIZE(expression [, 'field_delimiter'])&nbsp; &nbsp; &nbsp; &nbsp; </p>
            
</td>
         
</tr> 
   
</table>
<a name="N10701"></a><a name="Terms-N10701"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with data type chararray.</p>
            
</td>
         
</tr> 
          
<tr>
            
<td colspan="1" rowspan="1">
               
<p>'field_delimiter'</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An optional field delimiter (in single quotes).</p>
               
<p>If field_delimiter is null or not passed, the following will be used as delimiters: space [  ], double quote [ " ], coma [ , ] parenthesis [ () ], star [ * ].</p>
            
</td>
         
</tr>
   
</table>
<a name="N10733"></a><a name="Usage-N10733"></a>
<h4>Usage</h4>
<p>Use the TOKENIZE function to split a string of words (all words in a single tuple) into a bag of words (each word in a single tuple). </p>
<a name="N1073D"></a><a name="Example-N1073D"></a>
<h4>Example</h4>
<p>In this example the strings in each row are split.</p>
<pre class="code">
A  = LOAD 'data' AS (f1:chararray);

DUMP A;
(Here is the first string.)
(Here is the second string.)
(Here is the third string.)

X = FOREACH A GENERATE TOKENIZE(f1);

DUMP X;
({(Here),(is),(the),(first),(string.)})
({(Here),(is),(the),(second),(string.)})
({(Here),(is),(the),(third),(string.)})
</pre>
<p>In this example a field delimiter is specified.</p>
<pre class="code">
{code}
A = LOAD 'data' AS (f1:chararray);
B = FOREACH A TOKENIZE (f1,'||');
DUMP B;
{code} 
</pre>
</div>
   
   <!-- ======================================================================== -->
   
<a name="N10754"></a><a name="load-store-functions"></a>
<h2 class="h3">Load/Store Functions</h2>
<div class="section">
<p>Load/store functions determine how data goes into Pig and comes out of Pig. 
   Pig provides a set of built-in load/store functions, described in the sections below. 
   You can also write your own load/store functions  (see <a href="udf.html">User Defined Functions</a>).</p>
<a name="N10763"></a><a name="handling-compression"></a>
<h3 class="h4">Handling Compression</h3>
<p>Support for compression is determined by the load/store function. PigStorage and TextLoader support gzip and bzip compression for both read (load) and write (store). BinStorage does not support compression.</p>
<p>To work with gzip compressed files, input/output files need to have a .gz extension. Gzipped files cannot be split across multiple maps; this means that the number of maps created is equal to the number of part files in the input location.</p>
<pre class="code">
A = load &lsquo;myinput.gz&rsquo;;
store A into &lsquo;myoutput.gz&rsquo;; 
</pre>
<p>To work with bzip compressed files, the input/output files need to have a .bz or .bz2 extension. Because the compression is block-oriented, bzipped files can be split across multiple maps.</p>
<pre class="code">
A = load &lsquo;myinput.bz&rsquo;;
store A into &lsquo;myoutput.bz&rsquo;; 
</pre>
<p>Note: PigStorage and TextLoader correctly read compressed files as long as they are NOT CONCATENATED FILES generated in this manner: </p>
<ul>
      
<li>
         
<p>cat *.gz &gt; text/concat.gz</p>
      
</li>
      
<li>
         
<p>cat *.bz &gt; text/concat.bz </p>
      
</li>
      
<li>
         
<p>cat *.bz2 &gt; text/concat.bz2</p>
      
</li>
   
</ul>
<p></p>
<p>If you use concatenated gzip or bzip files with your Pig jobs, you will NOT see a failure but the results will be INCORRECT.</p>
<p></p>
<a name="N1079C"></a><a name="binstorage"></a>
<h3 class="h4">BinStorage</h3>
<p>Loads and stores data in machine-readable format.</p>
<a name="N107A5"></a><a name="Syntax-N107A5"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>BinStorage()&nbsp; &nbsp; &nbsp; &nbsp; </p>
            
</td>
         
</tr> 
   
</table>
<a name="N107B9"></a><a name="Terms-N107B9"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>none</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>no parameters</p>
            
</td>
         
</tr> 
   
</table>
<a name="N107D5"></a><a name="Usage-N107D5"></a>
<h4>Usage</h4>
<p>Pig uses BinStorage to load and store the temporary data that is generated between multiple MapReduce jobs.</p>
<ul>
   
<li>BinStorage works with data that is represented on disk in machine-readable format. 
   BinStorage does NOT support <a href="#Handling-Compression">compression</a>.</li>
   
<li>BinStorage supports multiple locations (files, directories, globs) as input.</li>
   
</ul>
<p></p>
<p>Occasionally, users use BinStorage to store their own data. However, because BinStorage is a proprietary binary format, the original data is never in BinStorage - it is always a derivation of some other data.</p>
<p>We have seen several examples of users doing something like this:</p>
<pre class="code">
a = load 'b.txt' as (id, f);
b = group a by id;
store b into 'g' using BinStorage();
</pre>
<p>And then later:</p>
<pre class="code">
a = load 'g/part*' using BinStorage() as (id, d:bag{t:(v, s)});
b = foreach a generate (double)id, flatten(d);
dump b;
</pre>
<p>There is a problem with this sequence of events. The first script does not define data types and, as the result, the data is stored as a bytearray and a bag with a tuple that contains two bytearrays. The second script attempts to cast the bytearray to double; however, since the data originated from a different loader, it has no way to know the format of the bytearray or how to cast it to a different type. To solve this problem, Pig:</p>
<ul>

<li>Sends an error message when the second script is executed: "ERROR 1118: Cannot cast bytes loaded from BinStorage. Please provide a custom converter."</li>

<a name="custom-converter"></a>
<li id="custom-converter">Allows you to use a custom converter to perform the casting. <br>

<pre class="code">
a = load 'g/part*' using BinStorage('Utf8StorageConverter') as (id, d:bag{t:(v, s)});
b = foreach a generate (double)id, flatten(d);
dump b;
</pre>

</li>

</ul>
<a name="N10812"></a><a name="Examples"></a>
<h4>Examples</h4>
<p>In this example BinStorage is used with the LOAD and STORE functions.</p>
<pre class="code">
A = LOAD 'data' USING BinStorage();

STORE X into 'output' USING BinStorage(); 
</pre>
<p>In this example BinStorage is used to load multiple locations.</p>
<pre class="code">
A = LOAD 'input1.bin, input2.bin' USING BinStorage();
</pre>
<p>BinStorage does not track data lineage. When Pig uses BinStorage to move data between MapReduce jobs, Pig can figure out the correct cast function to use and apply it. However, as shown in the example below, when you store data using BinStorage and then use a separate Pig Latin script to read data (thus loosing the type information), it is your responsibility to correctly cast the data before storing it using BinStorage.
 </p>
<pre class="code">
raw = load 'sampledata' using BinStorage() as (col1,col2, col3);
--filter out null columns
A = filter raw by col1#'bcookie' is not null;

B = foreach A generate col1#'bcookie'  as reqcolumn;
describe B;
--B: {regcolumn: bytearray}
X = limit B 5;
dump X;
(36co9b55onr8s)
(36co9b55onr8s)
(36hilul5oo1q1)
(36hilul5oo1q1)
(36l4cj15ooa8a)

B = foreach A generate (chararray)col1#'bcookie'  as convertedcol;
describe B;
--B: {convertedcol: chararray}
X = limit B 5;
dump X; 
()
()
()
()
()
</pre>
<a name="N10831"></a><a name="jsonloadstore"></a>
<h3 class="h4">JsonLoader, JsonStorage</h3>
<p>Load or store JSON data.</p>
<a name="N1083A"></a><a name="Syntax-N1083A"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>JsonLoader( [&lsquo;schema&rsquo;] ) </p>
            
</td>
        
</tr> 
        
<tr>
            
<td colspan="1" rowspan="1">
               
<p>JsonStorage( ) </p>
            
</td>
        
</tr> 
   
</table>
<a name="N10859"></a><a name="Terms-N10859"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>schema</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An optional Pig schema, in single quotes.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10875"></a><a name="Usage-N10875"></a>
<h4>Usage</h4>
<p>Use JsonLoader to load JSON data. </p>
<p>Use JsonStorage to store JSON data.</p>
<p>Note that there is no concept of delimit in JsonLoader or JsonStorer. The data is encoded in standard JSON format. JsonLoader optionally takes a schema as the construct argument.</p>
<a name="N10885"></a><a name="Examples-N10885"></a>
<h4>Examples</h4>
<p>In this example data is loaded with a schema. </p>
<pre class="code">
a = load 'a.json' using JsonLoader('a0:int,a1:{(a10:int,a11:chararray)},a2:(a20:double,a21:bytearray),a3:[chararray]');  
</pre>
<p>In this example data is loaded without a schema; it assumes there is a .pig_schema (produced by JsonStorage) in the input directory. </p>
<pre class="code">
a = load 'a.json' using JsonLoader(); 
</pre>
<a name="N1089C"></a><a name="pigdump"></a>
<h3 class="h4">PigDump</h3>
<p>Stores data in UTF-8 format.</p>
<a name="N108A5"></a><a name="Syntax-N108A5"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>PigDump()&nbsp; &nbsp; &nbsp; &nbsp; </p>
            
</td>
         
</tr> 
   
</table>
<a name="N108B9"></a><a name="Terms-N108B9"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>none</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>no parameters</p>
            
</td>
         
</tr> 
   
</table>
<a name="N108D5"></a><a name="Usage-N108D5"></a>
<h4>Usage</h4>
<p>PigDump stores data as tuples in human-readable UTF-8 format. </p>
<a name="N108DE"></a><a name="Example-N108DE"></a>
<h4>Example</h4>
<p>In this example PigDump is used with the STORE function.</p>
<pre class="code">
STORE X INTO 'output' USING PigDump();
</pre>
<a name="N108EE"></a><a name="pigstorage"></a>
<h3 class="h4">PigStorage</h3>
<p>Loads and stores data as structured text files.</p>
<a name="N108F7"></a><a name="Syntax-N108F7"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>PigStorage( [field_delimiter] , ['options'] )&nbsp;</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1090B"></a><a name="Terms-N1090B"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               <a name="field-delimiter"></a>
<p id="field-delimiter">field_delimiter</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The default field delimiter is tab ('\t'). </p>
               
<p>You can specify other characters as field delimiters; however, be sure to encase the characters in single quotes.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               <a name="pigstorage-options"></a>
<p id="pigstorage-options">'options'</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>A string that contains space-separated options (&lsquo;optionA  optionB  optionC&rsquo;)</p>
               
<p>Currently supported options are:</p>
               
<ul>
					
<li>(&lsquo;schema&rsquo;) - Stores the schema of the relation using a hidden JSON file.</li>
					
<li>(&lsquo;noschema&rsquo;) - Ignores a stored schema during the load.</li>
                                        
<li>('tagsource') - Add a first column indicates the input file of the record.</li>
				
</ul>
            
</td>
         
</tr> 
   
</table>
<a name="N1094E"></a><a name="Usage-N1094E"></a>
<h4>Usage</h4>
<p>PigStorage is the default function used by Pig to load/store the data. PigStorage supports structured text files (in human-readable UTF-8 format) in compressed or uncompressed form (see <a href="#Handling-Compression">Handling Compression</a>). All Pig <a href="basic.html#data-types">data types</a> (both simple and complex) can be read/written using this function. The input data to the load can be a file, a directory or a glob.</p>
<p>
<strong>Load/Store Statements</strong>
</p>
<p>Load statements &ndash; PigStorage expects data to be formatted using field delimiters, either the tab character  ('\t') or other specified character.</p>
<p>Store statements &ndash; PigStorage outputs data using field deliminters, either the tab character  ('\t') or other specified character, and the line feed record delimiter ('\n').  </p>
<p>
<strong>Field/Record Delimiters</strong>
</p>
<p>Field Delimiters &ndash; For load and store statements the default field delimiter is the tab character ('\t'). You can use other characters as field delimiters, but separators such as ^A or Ctrl-A should be represented in Unicode (\u0001) using UTF-16 encoding (see Wikipedia <a href="http://en.wikipedia.org/wiki/ASCII">ASCII</a>, <a href="http://en.wikipedia.org/wiki/Unicode">Unicode</a>, and <a href="http://en.wikipedia.org/wiki/UTF-16">UTF-16</a>).</p>
<p>Record Deliminters &ndash; For load statements Pig interprets the line feed ( '\n' ), carriage return ( '\r' or CTRL-M) and combined CR + LF ( '\r\n' ) characters as record delimiters (do not use these characters as field delimiters). For store statements Pig uses the line feed ('\n') character as the record delimiter.</p>
<p>
<strong>Schemas</strong>
</p>
<p>If the schema option is specified, a hidden ".pig_schema" file is created in the output directory when storing data. It is used by PigStorage (with or without -schema) during loading to determine the field names and types of the data without the need for a user to explicitly provide the schema in an as clause, unless <span class="codefrag">noschema</span> is specified. No attempt to merge conflicting schemas is made during loading. The first schema encountered during a file system scan is used. </p>
<p>Additionally, if the schema option is specified, a ".pig_headers" file is created in the output directory. This file simply lists the delimited aliases. This is intended to make export to tools that can read files with header lines easier (just cat the header to your data). </p>
<p>If the schema option is NOT specified, a schema will not be written when storing data.</p>
<p>If the noschema option is NOT specified, and a schema is found, it gets loaded when loading data.</p>
<p>Note that regardless of whether or not you store the schema, you always need to specify the correct delimiter to read your data. If you store reading delimiter "#" and then load using the default delimiter, your data will not be parsed correctly.</p>
<p>
<strong>Record Provenance</strong>
</p>
<p>If tagsource option is specified, PigStorage will add a psudo-column INPUT_FILE_NAME to the beginning of the record. As the name suggests, it is the input file name containing this particular record.</p>
<p>
<strong>Complex Data Types</strong>
</p>
<p>The formats for complex data types are shown here:</p>
<ul>
		
<li>
<a href="basic.html#tuple">Tuple</a>: enclosed by (), items separated by ","
		<ul>
			
<li>Non-empty tuple: (item1,item2,item3)</li>
		    
<li>Empty tuple is valid: ()</li>
		
</ul>
		
</li>
		
<li>
<a href="basic.html#bag">Bag</a>: enclosed by {}, tuples separated by ","
		<ul>
			
<li>Non-empty bag: {code}{(tuple1),(tuple2),(tuple3)}{code}</li>
		    
<li>Empty bag is valid: {}</li>
		
</ul>		
		
</li>
		
<li>
<a href="basic.html#map">Map</a>: enclosed by [], items separated by ",", key and value separated by "#"
		<ul>
			
<li>Non-empty map: [key1#value1,key2#value2]</li>
		    
<li>Empty map is valid: []</li>
		
</ul>		
		
</li>

</ul>
<p>If load statement specify a schema, Pig will convert the complex type according to schema. If conversion fails, the affected item will be null (see <a href="basic.html#nulls">Nulls and Pig Latin</a>). </p>
<a name="N109DB"></a><a name="Examples-N109DB"></a>
<h4>Examples</h4>
<p>In this example PigStorage expects input.txt to contain tab-separated fields and newline-separated records. The statements are equivalent.</p>
<pre class="code">
A = LOAD 'student' USING PigStorage('\t') AS (name: chararray, age:int, gpa: float); 

A = LOAD 'student' AS (name: chararray, age:int, gpa: float);
</pre>
<p>In this example PigStorage stores the contents of X into files with fields that are delimited with an asterisk ( * ). The STORE function specifies that the files will be located in a directory named output and that the files will be named part-nnnnn (for example, part-00000).</p>
<pre class="code">
STORE X INTO  'output' USING PigStorage('*');
</pre>
<p>In this example, PigStorage loads data with complex data type, a bag of map and double.</p>
<pre class="code">
a = load '1.txt' as (a0:{t:(m:map[int],d:double)});

{([foo#1,bar#2],34.0),([white#3,yellow#4],45.0)} : valid
{([foo#badint],baddouble)} : conversion fail for badint/baddouble, get {([foo#],)}
{} : valid, empty bag
</pre>
<a name="N109FA"></a><a name="textloader"></a>
<h3 class="h4">TextLoader</h3>
<p>Loads unstructured data in UTF-8 format.</p>
<a name="N10A03"></a><a name="Syntax-N10A03"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TextLoader()</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10A18"></a><a name="Terms-N10A18"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>none</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>no parameters</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10A34"></a><a name="Usage-N10A34"></a>
<h4>Usage</h4>
<p>TextLoader works with unstructured data in UTF8 format. Each resulting tuple contains a single field with one line of input text. TextLoader also supports <a href="#Handling-Compression">compression</a>.</p>
<p>Currently, TextLoader support for compression is limited.</p>
<p>TextLoader cannot be used to store data.</p>
<a name="N10A48"></a><a name="Example-N10A48"></a>
<h4>Example</h4>
<p>In this example TextLoader is used with the LOAD function.</p>
<pre class="code">
A = LOAD 'data' USING TextLoader();
</pre>
</div>
   

<!-- ======================================================== -->  
<!-- ======================================================== -->  
<!-- Math Functions -->

<a name="N10A5C"></a><a name="math-functions"></a>
<h2 class="h3">Math Functions</h2>
<div class="section">
<p>For general information about these functions, see the <a href="http://download.oracle.com/javase/6/docs/api/">Java API Specification</a>, 
<a href="http://download.oracle.com/javase/6/docs/api/java/lang/Math.html">Class Math</a>. Note the following:</p>
<ul>
		
<li>

<p>Pig function names are case sensitive and UPPER CASE.</p>
	
</li>
	
<li>

<p>Pig may process results differently than as stated in the Java API Specification:</p>

<ul>
	
<li>

<p>If the result value is null or empty, Pig returns null.</p>
	
</li>
		
<li>

<p>If the result value is not a number (NaN), Pig returns null.</p>
	
</li>
		
<li>

<p>If Pig is unable to process the expression, Pig returns an exception.</p>
	
</li>

</ul> 
	
</li>

</ul>
<a name="N10A93"></a><a name="abs"></a>
<h3 class="h4">ABS</h3>
<p>Returns the absolute value of an expression.</p>
<a name="N10A9C"></a><a name="Syntax-N10A9C"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>ABS(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10AB0"></a><a name="Terms-N10AB0"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>Any expression whose result is type int, long, float, or double.</p>
            
</td>
         
</tr>
          
   
</table>
<a name="N10ACC"></a><a name="Usage-N10ACC"></a>
<h4>Usage</h4>
<p>
	Use the ABS function to return the absolute value of an expression. 
    If the result is not negative (x &ge; 0), the result is returned. If the result is negative (x &lt; 0), the negation of the result is returned.
    </p>
<a name="N10AD9"></a><a name="acos"></a>
<h3 class="h4">ACOS</h3>
<p>Returns the arc cosine of an expression.</p>
<a name="N10AE2"></a><a name="Syntax-N10AE2"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>ACOS(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10AF6"></a><a name="Terms-N10AF6"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10B13"></a><a name="Usage-N10B13"></a>
<h4>Usage</h4>
<p>
Use the ACOS function to return the arc cosine of an expression.
  </p>
<a name="N10B20"></a><a name="asin"></a>
<h3 class="h4">ASIN</h3>
<p>Returns the arc sine of an expression.</p>
<a name="N10B29"></a><a name="Syntax-N10B29"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>ASIN(expression)</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10B3E"></a><a name="Terms-N10B3E"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10B5B"></a><a name="Usage-N10B5B"></a>
<h4>Usage</h4>
<p>
Use the ASIN function to return the arc sine of an expression.
     </p>
<a name="N10B68"></a><a name="atan"></a>
<h3 class="h4">ATAN</h3>
<p>Returns the arc tangent of an expression.</p>
<a name="N10B71"></a><a name="Syntax-N10B71"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>ATAN(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10B85"></a><a name="Terms-N10B85"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10BA2"></a><a name="Usage-N10BA2"></a>
<h4>Usage</h4>
<p>
Use the ATAN function to return the arc tangent of an expression.
     </p>
<a name="N10BAF"></a><a name="cbrt"></a>
<h3 class="h4">CBRT</h3>
<p>Returns the cube root of an expression.</p>
<a name="N10BB8"></a><a name="Syntax-N10BB8"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>CBRT(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10BCC"></a><a name="Terms-N10BCC"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10BE9"></a><a name="Usage-N10BE9"></a>
<h4>Usage</h4>
<p>
Use the CBRT function to return the cube root of an expression. 
</p>
<a name="N10BF6"></a><a name="ceil"></a>
<h3 class="h4">CEIL</h3>
<p>Returns the value of an expression rounded up to the nearest integer.
</p>
<a name="N10BFF"></a><a name="Syntax-N10BFF"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>CEIL(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10C13"></a><a name="Terms-N10C13"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10C30"></a><a name="Usage-N10C30"></a>
<h4>Usage</h4>
<p>
Use the CEIL function to return the value of an expression rounded up to the nearest integer. 
This function never decreases the result value.
     </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>x</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>CEIL(x)</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 4.6</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 5</p>
            
</td>
         
</tr>
        
        
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 3.5</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 4</p>
            
</td>
         
</tr>
        
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 2.4</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 3</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p>1.0</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>1</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-1.0</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-1</p>
            
</td>
         
</tr>
        
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-2.4</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-2</p>
            
</td>
         
</tr>
        
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-3.5</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-3</p>
            
</td>
         
</tr>
        
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-4.6</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-4</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10CEB"></a><a name="cos"></a>
<h3 class="h4">COS</h3>
<p>Returns the trigonometric cosine of an expression.
</p>
<a name="N10CF4"></a><a name="Syntax-N10CF4"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>COS(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10D08"></a><a name="Terms-N10D08"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression (angle) whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10D25"></a><a name="Usage-N10D25"></a>
<h4>Usage</h4>
<p>
Use the COS function to return the trigonometric cosine of an expression.
     </p>
<a name="N10D32"></a><a name="cosh"></a>
<h3 class="h4">COSH</h3>
<p>Returns the hyperbolic cosine of an expression.
</p>
<a name="N10D3B"></a><a name="Syntax-N10D3B"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>COSH(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10D4F"></a><a name="Terms-N10D4F"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10D6C"></a><a name="Usage-N10D6C"></a>
<h4>Usage</h4>
<p>
Use the COSH function to return the hyperbolic cosine of an expression. 
     </p>
<a name="N10D79"></a><a name="exp"></a>
<h3 class="h4">EXP</h3>
<p>Returns Euler's number e raised to the power of x.
</p>
<a name="N10D82"></a><a name="Syntax-N10D82"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>EXP(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10D96"></a><a name="Terms-N10D96"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10DB3"></a><a name="Usage-N10DB3"></a>
<h4>Usage</h4>
<p>
Use the EXP function to return the value of Euler's number e raised to the power of x (where x is the result value of the expression).
     </p>
<a name="N10DC0"></a><a name="floor"></a>
<h3 class="h4">FLOOR</h3>
<p>Returns the value of an expression rounded down to the nearest integer. 
</p>
<a name="N10DC9"></a><a name="Syntax-N10DC9"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>FLOOR(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10DDD"></a><a name="Terms-N10DDD"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10DFA"></a><a name="Usage-N10DFA"></a>
<h4>Usage</h4>
<p>
Use the FLOOR function to return the value of an expression rounded down to the nearest integer. 
This function never increases the result value.
     </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>x</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>CEIL(x)</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 4.6</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 4</p>
            
</td>
         
</tr>
        
        
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 3.5</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 3</p>
            
</td>
         
</tr>
        
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 2.4</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 2</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p>1.0</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>1</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-1.0</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-1</p>
            
</td>
         
</tr>
        
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-2.4</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-3</p>
            
</td>
         
</tr>
        
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-3.5</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-4</p>
            
</td>
         
</tr>
        
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-4.6</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-5</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10EB5"></a><a name="log"></a>
<h3 class="h4">LOG</h3>
<p>Returns the natural logarithm (base e) of an expression.</p>
<a name="N10EBE"></a><a name="Syntax-N10EBE"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>LOG(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10ED2"></a><a name="Terms-N10ED2"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10EEF"></a><a name="Usage-N10EEF"></a>
<h4>Usage</h4>
<p>
Use the LOG function to return the natural logarithm (base e) of an expression.
     </p>
<a name="N10EFC"></a><a name="log10"></a>
<h3 class="h4">LOG10</h3>
<p>Returns the base 10 logarithm of an expression.</p>
<a name="N10F05"></a><a name="Syntax-N10F05"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>LOG10(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10F19"></a><a name="Terms-N10F19"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10F36"></a><a name="Usage-N10F36"></a>
<h4>Usage</h4>
<p>
Use the LOG10 function to return the base 10 logarithm of an expression.
     </p>
<a name="N10F43"></a><a name="random"></a>
<h3 class="h4">RANDOM</h3>
<p>Returns a pseudo random number.</p>
<a name="N10F4C"></a><a name="Syntax-N10F4C"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>RANDOM( )</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10F60"></a><a name="Terms-N10F60"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>N/A</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>No terms.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10F7D"></a><a name="Usage-N10F7D"></a>
<h4>Usage</h4>
<p>
Use the RANDOM function to return a pseudo random number (type double) greater than or equal to 0.0 and less than 1.0.
     </p>
<a name="N10F8A"></a><a name="round"></a>
<h3 class="h4">ROUND</h3>
<p>Returns the value of an expression rounded to an integer.</p>
<a name="N10F93"></a><a name="Syntax-N10F93"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>ROUND(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N10FA7"></a><a name="Terms-N10FA7"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is type float or double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N10FC4"></a><a name="Usage-N10FC4"></a>
<h4>Usage</h4>
<p>
Use the ROUND function to return the value of an expression rounded to an integer (if the result type is float) or rounded to a long (if the result type is double).
     </p>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>x</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>CEIL(x)</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 4.6</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 5</p>
            
</td>
         
</tr>
        
        
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 3.5</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 4</p>
            
</td>
         
</tr>
        
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p> 2.4</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p> 2</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p>1.0</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>1</p>
            
</td>
         
</tr>
        
              
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-1.0</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-1</p>
            
</td>
         
</tr>
        
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-2.4</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-2</p>
            
</td>
         
</tr>
        
         
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-3.5</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-3</p>
            
</td>
         
</tr>
        
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>-4.6</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>-5</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N1107F"></a><a name="sin"></a>
<h3 class="h4">SIN</h3>
<p>Returns the sine of an expression.</p>
<a name="N11088"></a><a name="Syntax-N11088"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SIN(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1109C"></a><a name="Terms-N1109C"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N110B9"></a><a name="Usage-N110B9"></a>
<h4>Usage</h4>
<p>
Use the SIN function to return the sine of an expession. 
     </p>
<a name="N110C6"></a><a name="sinh"></a>
<h3 class="h4">SINH</h3>
<p>Returns the hyperbolic sine of an expression.</p>
<a name="N110CF"></a><a name="Syntax-N110CF"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SINH(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N110E3"></a><a name="Terms-N110E3"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N11100"></a><a name="Usage-N11100"></a>
<h4>Usage</h4>
<p>
Use the SINH function to return the hyperbolic sine of an expression. 
     </p>
<a name="N1110D"></a><a name="sqrt"></a>
<h3 class="h4">SQRT</h3>
<p>Returns the positive square root of an expression.</p>
<a name="N11116"></a><a name="Syntax-N11116"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SQRT(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1112A"></a><a name="Terms-N1112A"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N11147"></a><a name="Usage-N11147"></a>
<h4>Usage</h4>
<p>
Use the SQRT function to return the positive square root of an expression. 
     </p>
<a name="N11154"></a><a name="tan"></a>
<h3 class="h4">TAN</h3>
<p>Returns the trignometric tangent of an angle.</p>
<a name="N1115D"></a><a name="Syntax-N1115D"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TAN(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11171"></a><a name="Terms-N11171"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression (angle) whose result is double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N1118E"></a><a name="Usage-N1118E"></a>
<h4>Usage</h4>
<p>
Use the TAN function to return the trignometric tangent of an angle.
     </p>
<a name="N1119B"></a><a name="tanh"></a>
<h3 class="h4">TANH</h3>
<p>Returns the hyperbolic tangent of an expression. </p>
<a name="N111A4"></a><a name="Syntax-N111A4"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TANH(expression)</p>
            
</td>
         
</tr> 
   
</table>
<a name="N111B8"></a><a name="Terms-N111B8"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is double.</p>
            
</td>
         
</tr>
        
   
</table>
<a name="N111D5"></a><a name="Usage-N111D5"></a>
<h4>Usage</h4>
<p>
Use the TANH function to return the hyperbolic tangent of an expression. 
     </p>
</div>
<!-- End Math Functions --> 


<!-- ======================================================== -->
<!-- ======================================================== -->   

<!-- String Functions -->

<a name="N111E9"></a><a name="string-functions"></a>
<h2 class="h3">String Functions</h2>
<div class="section">
<p>For general information about these functions, see the <a href="http://download.oracle.com/javase/6/docs/api/">Java API Specification</a>, 
<a href="http://download.oracle.com/javase/6/docs/api/java/lang/String.html">Class String</a>. Note the following:</p>
<ul>
	
<li>

<p>Pig function names are case sensitive and UPPER CASE.</p>
	
</li>
		
<li>

<p>Pig string functions have an extra, first parameter: the string to which all the operations are applied.</p>
	
</li>
		
<li>

<p>Pig may process results differently than as stated in the Java API Specification. If any of the input parameters are null or if an insufficient number of parameters are supplied, NULL is returned.</p>
	
</li>


</ul>
<a name="N11211"></a><a name="indexof"></a>
<h3 class="h4">INDEXOF</h3>
<p>Returns the index of the first occurrence of a character in a string, searching forward from a start index. </p>
<a name="N1121A"></a><a name="Syntax-N1121A"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>INDEXOF(string, 'character', startIndex)</p>
            
</td>
         
</tr>
   
</table>
<a name="N1122F"></a><a name="Terms-N1122F"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string to be searched.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>'character'</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The character being searched for, in quotes. </p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>startIndex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The index from which to begin the forward search. </p>
               
<p>The string index begins with zero (0).</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11275"></a><a name="Usage-N11275"></a>
<h4>Usage</h4>
<p>
Use the INDEXOF function to determine the index of the first occurrence of a character in a string. The forward search for the character begins at the designated start index.
     </p>
<a name="N11282"></a><a name="last-index-of"></a>
<h3 class="h4">LAST_INDEX_OF</h3>
<p>Returns the index of the last occurrence of a character in a string, searching backward from a start index. </p>
<a name="N1128B"></a><a name="Syntax-N1128B"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>LAST_INDEX_OF(expression)</p>
            
</td>
         
</tr>
   
</table>
<a name="N112A0"></a><a name="Terms-N112A0"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string to be searched.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>'character'</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The character being searched for, in quotes.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>startIndex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The index from which to begin the backward search.</p>
               
<p>The string index begins with zero (0).</p>
            
</td>
         
</tr> 
   
</table>
<a name="N112E6"></a><a name="Usage-N112E6"></a>
<h4>Usage</h4>
<p>
Use the LAST_INDEX_OF function to determine the index of the last occurrence of a character in a string. The backward search for the character begins at the designated start index.
     </p>
<a name="N112F3"></a><a name="lcfirst"></a>
<h3 class="h4">LCFIRST</h3>
<p>Converts the first character in a string to lower case. </p>
<a name="N112FC"></a><a name="Syntax-N112FC"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>LCFIRST(expression)</p>
            
</td>
         
</tr>
   
</table>
<a name="N11311"></a><a name="Terms-N11311"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result type is chararray.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1132E"></a><a name="Usage-N1132E"></a>
<h4>Usage</h4>
<p>
Use the LCFIRST function to convert only the first character in a string to lower case. 
     </p>
<a name="N1133B"></a><a name="lower"></a>
<h3 class="h4">LOWER</h3>
<p>Converts all characters in a string to lower case. </p>
<a name="N11344"></a><a name="Syntax-N11344"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>LOWER(expression)</p>
            
</td>
         
</tr>
   
</table>
<a name="N11359"></a><a name="Terms-N11359"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result type is chararray.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11376"></a><a name="Usage-N11376"></a>
<h4>Usage</h4>
<p>
Use the LOWER function to convert all characters in a string to lower case. 
     </p>
<a name="N11383"></a><a name="regex-extract"></a>
<h3 class="h4">REGEX_EXTRACT </h3>
<p>Performs regular expression matching and extracts the matched group defined by an index parameter. </p>
<a name="N1138C"></a><a name="Syntax-N1138C"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>REGEX_EXTRACT (string, regex, index)</p>
            
</td>
         
</tr>
   
</table>
<a name="N113A1"></a><a name="Terms-N113A1"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string in which to perform the match.</p>
            
</td>
         
</tr> 
        
<tr>
            
<td colspan="1" rowspan="1">
               
<p>regex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The regular expression.</p>
            
</td>
         
</tr> 
         
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>index</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The index of the matched group to return.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N113E4"></a><a name="Usage-N113E4"></a>
<h4>Usage</h4>
<p>
Use the REGEX_EXTRACT function to perform regular expression matching and to extract the matched group defined by the index parameter (where the index is a 1-based parameter.) The function uses Java regular expression form.
     </p>
<p>
The function returns a string that corresponds to the matched group in the position specified by the index. If there is no matched expression at that position, NULL is returned.
     </p>
<a name="N113F1"></a><a name="Example-N113F1"></a>
<h4>Example</h4>
<p>
This example will return the string '192.168.1.5'.
     </p>
<pre class="code">
REGEX_EXTRACT('192.168.1.5:8020', '(.*)\:(.*)', 1);
</pre>
<a name="N11402"></a><a name="regex-extract-all"></a>
<h3 class="h4">REGEX_EXTRACT_ALL </h3>
<p>Performs regular expression matching and extracts all matched groups.</p>
<a name="N1140B"></a><a name="Syntax-N1140B"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>REGEX_EXTRACT (string, regex)</p>
            
</td>
         
</tr>
   
</table>
<a name="N11420"></a><a name="Terms-N11420"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string in which to perform the match.</p>
            
</td>
         
</tr> 
         
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>regex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The regular expression.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11450"></a><a name="Usage-N11450"></a>
<h4>Usage</h4>
<p>
Use the REGEX_EXTRACT_ALL function to perform regular expression matching and to extract all matched groups. The function uses Java regular expression form.
     </p>
<p>
The function returns a tuple where each field represents a matched expression. If there is no match, an empty tuple is returned.
     </p>
<a name="N1145D"></a><a name="Example-N1145D"></a>
<h4>Example</h4>
<p>
This example will return the tuple (192.168.1.5,8020).
     </p>
<pre class="code">
REGEX_EXTRACT_ALL('192.168.1.5:8020', '(.*)\:(.*)');
</pre>
<a name="N1146E"></a><a name="replace"></a>
<h3 class="h4">REPLACE</h3>
<p>Replaces existing characters in a string with new characters.</p>
<a name="N11477"></a><a name="Syntax-N11477"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>REPLACE(string, 'oldChar', 'newChar');</p>
            
</td>
         
</tr>  
   
</table>
<a name="N1148C"></a><a name="Terms-N1148C"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string to be updated.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>'oldChar'</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The existing characters being replaced, in quotes. </p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>'newChar'</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The new characters replacing the existing characters, in quotes.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N114CF"></a><a name="Usage-N114CF"></a>
<h4>Usage</h4>
<p>
Use the REPLACE function to replace existing characters in a string with new characters.
     </p>
<p>
For example, to change "open source software" to "open source wiki" use this statement: 
REPLACE(string,'software','wiki');
     </p>
<a name="N114DF"></a><a name="strsplit"></a>
<h3 class="h4">STRSPLIT</h3>
<p>Splits a string around matches of a given regular expression. </p>
<a name="N114E8"></a><a name="Syntax-N114E8"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>STRSPLIT(string, regex, limit)</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N114FC"></a><a name="Terms-N114FC"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string to be split.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>regex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The regular expression.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>Limit</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The number of times the pattern (the compiled representation of the regular expression) is applied.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N1153F"></a><a name="Usage-N1153F"></a>
<h4>Usage</h4>
<p>
Use the STRSPLIT function to split a string around matches of a given regular expression.
     </p>
<p>
For example, given the string (open:source:software), STRSPLIT (string, ':',2) will return ((open,source:software)) and STRSPLIT (string, ':',3) will return ((open,source,software)).
     </p>
<a name="N1154F"></a><a name="substring"></a>
<h3 class="h4">SUBSTRING</h3>
<p>Returns a substring from a given string. </p>
<a name="N11558"></a><a name="Syntax-N11558"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>SUBSTRING(string, startIndex, stopIndex)</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N1156C"></a><a name="Terms-N1156C"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
          
<tr>
            
<td colspan="1" rowspan="1">
               
<p>string</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The string from which a substring will be extracted.</p>
            
</td>
         
</tr> 
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>startIndex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The index (type integer) of the first character of the substring.</p>
               
<p>The index of a string begins with zero (0).</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>stopIndex</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The index (type integer) of the character <em>following</em> the last character of the substring.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N115B5"></a><a name="Usage-N115B5"></a>
<h4>Usage</h4>
<p>
Use the SUBSTRING function to return a substring from a given string. 
     </p>
<p>  
Given a field named alpha whose value is ABCDEF, to return substring BCD use this statement: SUBSTRING(alpha,1,4). Note that 1 is the index of B (the first character of the substring) and  4 is the index of E  (the character <em>following</em> the last character of the substring).
     </p>
<a name="N115C8"></a><a name="trim"></a>
<h3 class="h4">TRIM</h3>
<p>Returns a copy of a string with leading and trailing white space removed.</p>
<a name="N115D1"></a><a name="Syntax-N115D1"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TRIM(expression)</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N115E5"></a><a name="Terms-N115E5"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result is chararray. </p>
            
</td>
         
</tr> 
   
</table>
<a name="N11602"></a><a name="Usage-N11602"></a>
<h4>Usage</h4>
<p>
Use the TRIM function to remove leading and trailing white space from a string.
     </p>
<a name="N1160F"></a><a name="ucfirst"></a>
<h3 class="h4">UCFIRST</h3>
<p>Returns a string with the first character converted to upper case. </p>
<a name="N11618"></a><a name="Syntax-N11618"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>UCFIRST(expression)</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N1162C"></a><a name="Terms-N1162C"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result type is chararray.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11649"></a><a name="Usage-N11649"></a>
<h4>Usage</h4>
<p>
Use the UCFIRST function to convert only the first character in a string to upper case. 
     </p>
<a name="N11656"></a><a name="upper"></a>
<h3 class="h4">UPPER</h3>
<p>Returns a string converted to upper case. </p>
<a name="N1165F"></a><a name="Syntax-N1165F"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>UPPER(expression)</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N11673"></a><a name="Terms-N11673"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression whose result type is chararray. </p>
            
</td>
         
</tr> 
   
</table>
<a name="N11690"></a><a name="Usage-N11690"></a>
<h4>Usage</h4>
<p>
Use the UPPER function to convert all characters in a string to upper case.
     </p>
</div>
<!-- End String Functions -->


<!-- ======================================================== -->
<!-- ======================================================== -->
<!-- Other Functions -->

<a name="N116A4"></a><a name="bag-tuple-functions"></a>
<h2 class="h3">Tuple, Bag, Map Functions</h2>
<div class="section">
<a name="N116AC"></a><a name="totuple"></a>
<h3 class="h4">TOTUPLE</h3>
<p>Converts one or more expressions to type tuple. </p>
<a name="N116B5"></a><a name="Syntax-N116B5"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TOTUPLE(expression [, expression ...])</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N116CA"></a><a name="Terms-N116CA"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression of any datatype.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N116E7"></a><a name="Usage-N116E7"></a>
<h4>Usage</h4>
<p>Use the TOTUPLE function to convert one or more expressions to a tuple.</p>
<p>See also: <a href="basic.html#tuple">Tuple</a> data type and <a href="basic.html#type-construction">Type Construction Operators</a>
</p>
<a name="N116FB"></a><a name="Example-N116FB"></a>
<h4>Example</h4>
<p>
In this example, fields f1, f2 and f3 are converted to a tuple.
     </p>
<pre class="code">
a = LOAD 'student' AS (f1:chararray, f2:int, f3:float);
DUMP a;

(John,18,4.0)
(Mary,19,3.8)
(Bill,20,3.9)
(Joe,18,3.8)

b = FOREACH a GENERATE TOTUPLE(f1,f2,f3);
DUMP b;

((John,18,4.0))
((Mary,19,3.8))
((Bill,20,3.9))
((Joe,18,3.8))
</pre>
<a name="N1170C"></a><a name="tobag"></a>
<h3 class="h4">TOBAG</h3>
<p>Converts one or more expressions to type bag. </p>
<a name="N11715"></a><a name="Syntax-N11715"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TOBAG(expression [, expression ...])</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N1172A"></a><a name="Terms-N1172A"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression with any data type.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11747"></a><a name="Usage-N11747"></a>
<h4>Usage</h4>
<p>Use the TOBAG function to convert one or more expressions to individual tuples which are then placed in a bag.</p>
<p>See also: <a href="basic.html#bag">Bag</a> data type and <a href="basic.html#type-construction">Type Construction Operators</a>
</p>
<a name="N1175B"></a><a name="Example-N1175B"></a>
<h4>Example</h4>
<p>
In this example, fields f1 and f3 are converted to tuples that are then placed in a bag.
     </p>
<pre class="code">
a = LOAD 'student' AS (f1:chararray, f2:int, f3:float);
DUMP a;

(John,18,4.0)
(Mary,19,3.8)
(Bill,20,3.9)
(Joe,18,3.8)

b = FOREACH a GENERATE TOBAG(f1,f3);
DUMP b;

({(John),(4.0)})
({(Mary),(3.8)})
({(Bill),(3.9)})
({(Joe),(3.8)})
</pre>
<a name="N1176C"></a><a name="tomap"></a>
<h3 class="h4">TOMAP</h3>
<p>Converts key/value expression pairs into a map. </p>
<a name="N11775"></a><a name="Syntax-N11775"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TOMAP(key-expression, value-expression [, key-expression, value-expression ...])</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N1178A"></a><a name="Terms-N1178A"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>key-expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression of type chararray.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>value-expression</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>An expression of any type supported by a map.</p>
            
</td>
         
</tr>
   
</table>
<a name="N117BA"></a><a name="Usage-N117BA"></a>
<h4>Usage</h4>
<p>Use the TOMAP function to convert pairs of expressions into a map. Note the following:</p>
<ul>

<li>You must supply an even number of expressions as parameters</li>

<li>The elements must comply with map type rules:
<ul>

<li>Every odd element (key-expression) must be a chararray since only chararrays can be keys into the map</li>

<li>Every even element (value-expression) can be of any type supported by a map. </li>

</ul>

</li>
     
</ul>
<p></p>
<p>See also: <a href="basic.html#map">Map</a> data type and  <a href="basic.html#type-construction">Type Construction Operators</a>
</p>
<a name="N117E2"></a><a name="Example-N117E2"></a>
<h4>Example</h4>
<p>
In this example, student names (type chararray) and student GPAs (type float) are used to create three maps.
     </p>
<pre class="code">
A = load 'students' as (name:chararray, age:int, gpa:float);
B = foreach A generate TOMAP(name, gpa);
store B into &lsquo;results&rsquo;;

Input (students)
joe smith 20 3.5
amy chen 22 3.2
leo allen 18 2.1

Output (results)
[joe smith#3.5]
[amy chen#3.2]
[leo allen#2.1]
</pre>
<a name="N117F3"></a><a name="topx"></a>
<h3 class="h4">TOP</h3>
<p>Returns the top-n tuples from a bag of tuples.</p>
<a name="N117FC"></a><a name="Syntax-N117FC"></a>
<h4>Syntax</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>TOP(topN,column,relation)</p>
            
</td>
         
</tr> 
        
   
</table>
<a name="N11811"></a><a name="Terms-N11811"></a>
<h4>Terms</h4>
<table class="ForrestTable" cellspacing="1" cellpadding="4">
       
<tr>
            
<td colspan="1" rowspan="1">
               
<p>topN</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The number of top tuples to return (type integer).</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>column</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The tuple column whose values are being compared.</p>
            
</td>
         
</tr> 
                
<tr>
            
<td colspan="1" rowspan="1">
               
<p>relation</p>
            
</td>
            <td colspan="1" rowspan="1">
               
<p>The relation (bag of tuples) containing the tuple column.</p>
            
</td>
         
</tr> 
   
</table>
<a name="N11854"></a><a name="Usage-N11854"></a>
<h4>Usage</h4>
<p>
TOP function returns a bag containing top N tuples from the input bag where N is controlled by the first parameter to the function. The tuple comparison is performed based on a single column from the tuple. The column position is determined by the second parameter to the function. The function assumes that all tuples in the bag contain an element of the same type in the compared column
     </p>
<a name="N1185E"></a><a name="Example-N1185E"></a>
<h4>Example</h4>
<p>
In this example the top 10 occurrences are returned.
     </p>
<pre class="code">
A = LOAD 'data' as (first: chararray, second: chararray);
B = GROUP A BY (first, second);
C = FOREACH B generate FLATTEN(group), COUNT(*) as count;
D = GROUP C BY first; // again group by first
topResults = FOREACH D {
    result = TOP(10, 2, C); // and retain top 10 occurrences of 'second' in first
    GENERATE FLATTEN(result);
}
</pre>
</div>
<!-- End Other Functions -->

  
</div>
<!--+
    |end content
    +-->
<div class="clearboth">&nbsp;</div>
</div>
<div id="footer">
<!--+
    |start bottomstrip
    +-->
<div class="lastmodified">
<script type="text/javascript"><!--
document.write("Last Published: " + document.lastModified);
//  --></script>
</div>
<div class="copyright">
        Copyright &copy;
         2007-2012 <a href="http://www.apache.org/licenses/">The Apache Software Foundation.</a>
</div>
<!--+
    |end bottomstrip
    +-->
</div>
</body>
</html>
